{% extends "::baseForAdmin.html.twig" %}
{% block title %}
    Affecter Enseignant à une matière
{% endblock %}
{% block script %}
    <script language="JavaScript">
        $("document").ready(function () {


            $("#envoyer").click(function () {
                console.log("hey");
                var check = ' <i class="ace-icon fa fa-check green bigger-300" id="mySpinner"> ';
                var spinner = ' <i class="ace-icon fa fa-spin fa-refresh blue bigger-300" id="mySpinner"> ';
                if ($("#matiere").val() == "null" || $("#groupe").val() == "null") {
                    $(".alert-danger").html("Veuillez sélectionner une matiere et un groupe !");
                    $(".alert-danger").slideDown();
                    setTimeout(function () {
                        $(".alert-danger").slideUp();
                        $(".alert-danger").html("");

                    }, 5000);

                } else {
                    $("#td").html(spinner);
                    $.ajax({
                        url: "{{ path('affecterEnseignantGroupeAjax') }}",
                        method: "POST",
                        data: $("#form").serialize(),
                        success: function (response) {
                            response = JSON.parse(response);
                            if (response.status == "affected") {
                                $("#td").html(check);
                                setTimeout(function () {
                                    window.location.assign("{{ path('listerEnseignant') }}");
                                }, 1000);
                            }


                        }

                    });


                }


            });
        });
    </script>


{% endblock %}
{% block mainContent %}
    <hr class="hr-4">
    <div class="col-xs-12">
        <div class="row" align="center">
            <h3>{{ enseignant.nomEnseignant }} {{ enseignant.prenomEnseignant }}</h3>
        </div>
        <div class="row">
            <div class="alert alert-danger" style="display: none;"></div>
            <form name="form" id="form">
                <input type="hidden" name="enseignant" value="{{ enseignant.matriculeEnseignant }}">
                <table border="1" align="center" width="70%" class="table table-bordered table-responsive">
                    <tr class="table-header">
                        <td>Matiere</td>
                        <td>Groupe</td>
                    </tr>
                    <tr align="center">
                        <td><select id="matiere" name="matiere">
                                <option value="null">Sélectionner une matière</option>
                                {% for matiere in listMatiere %}
                                    <option value="{{ matiere.libelleMatiere }}">{{ matiere.libelleMatiere }}</option>
                                {% endfor %}
                            </select></td>
                        <td>
                            <select name="groupe" id="groupe">
                                <option value="null">Sélectionner un groupe</option>
                                {% for groupe in listGroupe %}
                                    <option value="{{ groupe.id }}">{{ groupe.nomgroupe }} {{ groupe.numgroupe }}</option>
                                {% endfor %}

                            </select></td>

                    </tr>
                    <tr align="center">
                        <td colspan="2" id="td"><input type="button" value="Affecter" class="btn btn-primary"
                                                       id="envoyer"></td>
                    </tr>

                </table>
            </form>
        </div>


    </div>




{% endblock %}