{% extends "::baseForAdmin.html.twig" %}
    {% block title %}
        Lister les enseignants
    {% endblock %}

    {% block script %}
        <script language="JavaScript">
            $("document").ready(function () {
                $("#btnLister").click(function () {
                    var idGrade = $("#gradeList").val();
                    var tableau = "<table border='1' class='table table-bordered' id='enseignantTable'><tr><th>Matricule</th><th>Nom</th><th>Prenom</th><th>CIN</th><th>Adresse</th><th>E-mail</th><th>NumTel</th></tr></table>";
                    $("#mySpinner").fadeIn("slow");
                    $("#tableContainer").slideUp("fast");
                    $("#alertVide").slideUp("fast");

                    $.ajax({
                        url: "{{ path('ListerEnseignantAJAX') }}",
                        method: "GET",
                        data: {"idGrade": idGrade},
                        success: function (response) {
                            var lines = "";
                            console.log(response);
                            response = JSON.parse(response);
                            console.log(response.listEnseignant);
                            if (response.listEnseignant.length == 0) {
                                $("#alertVide").slideDown("fast");
                                $("#tableContainer").slideUp("fast");
                            } else {
                                $.each(response.listEnseignant, function (i, item) {
                                    lines += "<tr><td>" + item.matricule_enseignant + "</td><td>" + item.nom_enseignant + "</td><td>" + item.prenom_enseignant + "</td><td>" + item.cin_enseignant + "</td><td>" + item.adresse_enseignant + "</td><td>" + item.email_enseignant + "</td><td>" + item.num_tel_enseignant + "</td></tr>";
                                });
                                $("#tableBody").html(lines);
                                $("#tableEnseignant").dataTable();
                                $("#alertVide").slideUp("fast");
                                $("#tableContainer").slideDown("fast");
                            }
                        }
                    });
                    $("#mySpinner").fadeOut("slow");
                });
            });
        </script>
    {% endblock %}

    {% block mainContent %}
        <hr class="hr-4">
        <div class="col-xs-12">
            <div class="row" align="center">
                <select name="gradeList" id="gradeList">
                    {% for g in grades %}
                        <option value="{{ g.id }}">{{ g.nomGrade }}</option>
                    {% endfor %}
                </select>
                <input type="button" value="Lister" id="btnLister" class="btn btn-primary">
            </div>
            <hr class="hr-2">
            <div class="row">
                <center><i class="ace-icon fa fa-spin fa-refresh blue bigger-300" id="mySpinner"
                           style="display: none"></i></center>
                <div class="alert alert-warning" id="alertVide" style="display: none">Aucun enseignant n'appartient a
                    cet grade!
                </div>
                <div id="tableContainer" style="display: none">
                    <table id="tableEnseignant" class="display" cellspacing="0" width="80%">
                        <thead>
                        <tr>
                            <th>Matricule</th>
                            <th>Nom</th>
                            <th>Prenom</th>
                            <th>Cin</th>
                            <th>Adresse</th>
                            <th>Email</th>
                            <th>Numéro de téléphone</th>
                        </tr>
                        </thead>
                        <tfoot>
                        <tr>
                            <th>Matricule</th>
                            <th>Nom</th>
                            <th>Prenom</th>
                            <th>Cin</th>
                            <th>Adresse</th>
                            <th>Email</th>
                            <th>Numéro de téléphone</th>
                        </tr>
                        </tfoot>
                        <tbody id="tableBody">

                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    {% endblock %}